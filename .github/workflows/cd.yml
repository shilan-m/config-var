name: Deployment
on:
  push:
    branches: ['improve-cd-pipelines','main']

concurrency: cd-${{ github.ref }}

jobs:
  deploy:
    name: Deploy
    continue-on-error: true
    runs-on: ubuntu-latest
    env:
      FORGE_EMAIL: ${{ vars.FORGE_EMAIL }}
      FORGE_API_TOKEN: ${{ secrets.FORGE_API_TOKEN }}
    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js and install dependencies
        uses: servicerocket/actions/common/yarn-cached-dependencies@master
        with:
          node-version: 16

      - name: Set deployment environment
        uses: ./.github/actions/set-envrionment

      # - name: Install Forge CLI
      #   run: npm install -g @forge/cli
      
      - name: check consolidation 1
        run: echo "The value of FORGE_EMAIL is $FORGE_EMAIL" 
        env:
          FORGE_EMAIL: ${{ vars.FORGE_EMAIL }}